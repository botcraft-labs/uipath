<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bot Craft Resume Studio - Pro Edition</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:wght@700&family=Montserrat:wght@700&family=Fira+Code:wght@400;700&family=Quicksand:wght@600&display=swap');
    :root { --glass: rgba(255, 255, 255, 0.1); --border: rgba(255, 255, 255, 0.2); --accent: #38bdf8; --neon: 0 0 10px rgba(56, 189, 248, 0.6); }
    body { font-family: 'Inter', sans-serif; background: radial-gradient(circle at top right, #1e293b, #020617); min-height: 100vh; color: #f8fafc; padding-top: 80px; }
    .glass-panel { background: var(--glass); backdrop-filter: blur(12px); border: 1px solid var(--border); border-radius: 20px; padding: 25px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); }
    .glass-btn { background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(8px); border: 1px solid var(--border); color: white; transition: 0.3s; font-weight: 600; border-radius: 8px; font-size: 0.8rem; }
    .glass-btn:hover { background: rgba(255, 255, 255, 0.2); border-color: var(--accent); box-shadow: 0 0 15px var(--accent); transform: translateY(-1px); }
    .form-control, .rich-editor { background: rgba(255,255,255,0.05) !important; border: 1px solid var(--accent) !important; color: rgba(255, 255, 255, 0.7) !important; box-shadow: var(--neon); transition: 0.3s; }
    .form-control:focus, .rich-editor:focus { box-shadow: 0 0 20px var(--accent); outline: none; color: rgba(255, 255, 255, 0.9) !important; }
    .form-control::placeholder { color: rgba(255, 255, 255, 0.4) !important; }
    .resume-preview { background: white; color: #1e293b; border-radius: 8px; min-height: 1120px; padding: 45px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); font-size: 0.9rem; overflow-wrap: break-word; }
    .sec-item { page-break-inside: avoid; margin-bottom: 1.2rem; }
    .section-header { border-bottom: 2px solid #334155; margin: 15px 0 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
    .rich-editor { min-height: 50px; padding: 8px; border-radius: 5px; font-size: 0.85rem; }
    .toolbar { display: flex; gap: 2px; margin-bottom: 4px; }
    .toolbar button { padding: 1px 6px; font-size: 0.65rem; background: rgba(255,255,255,0.1); color: white; border: 1px solid var(--border); border-radius: 4px; }
    .template-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
    .template-btn { border: 1px solid var(--border); cursor: pointer; padding: 6px; border-radius: 8px; text-align: center; background: rgba(255,255,255,0.05); font-size: 0.65rem; color: #cbd5e1; transition: 0.2s; }
    .template-btn.active { border-color: var(--accent); background: rgba(56,189,248,0.2); box-shadow: var(--neon); color:white; }
    .entry-card { background: rgba(0,0,0,0.2); border: 1px solid var(--border); padding: 12px; border-radius: 12px; margin-bottom: 12px; position: relative; }
    label { font-size: 0.65rem; color: #94a3b8; font-weight: 700; text-transform: uppercase; margin-bottom: 2px; display: block; }
    #photo-preview-container { width: 70px; height: 70px; border-radius: 10px; border: 2px dashed var(--border); display: flex; align-items: center; justify-content: center; overflow: hidden; background: rgba(0,0,0,0.2); }
    #photo-preview-container img { width: 100%; height: 100%; object-fit: cover; }
    .config-section { margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }
</style>
</head>
<body>

<nav class="navbar fixed-top bg-dark border-bottom border-secondary">
    <div class="container-fluid px-4">
        <span class="navbar-brand text-info fw-bold">✨ BOT CRAFT STUDIO</span>
        <div class="d-flex gap-2">
            <button class="btn glass-btn" onclick="exportJSON()">Save Project</button>
            <button class="btn glass-btn" onclick="document.getElementById('importInput').click()">Load</button>
            <input type="file" id="importInput" style="display:none" onchange="importJSON(event)">
            <button class="btn glass-btn-danger glass-btn px-3" onclick="resetForm()">Reset</button>
            <button class="btn glass-btn px-4" style="background: rgba(56, 189, 248, 0.2)" onclick="exportPDF()">Download PDF</button>
        </div>
    </div>
</nav>

<div class="container-fluid px-4">
    <div class="row g-4">
        <div class="col-lg-5" style="height: calc(100vh - 100px); overflow-y: auto;">
            <div class="glass-panel">
                <div class="config-section">
                    <div class="row g-2">
                        <div class="col-4"><label>Accent</label><input type="color" class="form-control p-1" value="#38bdf8" oninput="updateAccent(this.value)"></div>
                        <div class="col-4"><label>Font Color</label><input type="color" id="fontColor" class="form-control p-1" value="#1e293b" oninput="liveUpdate()"></div>
                        <div class="col-4"><label>Paper Color</label><input type="color" id="bgColor" class="form-control p-1" value="#ffffff" oninput="liveUpdate()"></div>
                    </div>
                </div>

                <div class="config-section">
                    <label>Layout Style</label>
                    <div class="template-grid">
                        <div class="template-btn active" onclick="setStyle('apollo', this)">Apollo</div>
                        <div class="template-btn" onclick="setStyle('classic', this)">Classic</div>
                        <div class="template-btn" onclick="setStyle('modern', this)">Modern</div>
                        <div class="template-btn" onclick="setStyle('sidebar', this)">Sidebar</div>
                        <div class="template-btn" onclick="setStyle('executive', this)">Executive</div>
                        <div class="template-btn" onclick="setStyle('midnight', this)">Midnight</div>
                        <div class="template-btn" onclick="setStyle('creative', this)">Creative</div>
                        <div class="template-btn" onclick="setStyle('tech', this)">Tech</div>
                        <div class="template-btn" onclick="setStyle('timeline', this)">Timeline</div>
                        <div class="template-btn" onclick="setStyle('grid', this)">Grid</div>
                        <div class="template-btn" onclick="setStyle('optimism', this)">Optimism</div>
                        <div class="template-btn" onclick="setStyle('startup', this)">Startup</div>
                        <div class="template-btn" onclick="setStyle('bold', this)">Bold</div>
                        <div class="template-btn" onclick="setStyle('minimal', this)">Minimal</div>
                        <div class="template-btn" onclick="setStyle('elegant', this)">Elegant</div>
                        <div class="template-btn" onclick="setStyle('monochrome', this)">Mono</div>
                        <div class="template-btn" onclick="setStyle('aura', this)">Aura</div>
                        <div class="template-btn" onclick="setStyle('clean', this)">Clean</div>
                    </div>
                </div>

                <div class="config-section">
                    <label>Photo</label>
                    <div class="d-flex gap-2 align-items-center">
                        <div id="photo-preview-container"><img id="profileImg" src="" style="display:none"><span id="photo-placeholder">+</span></div>
                        <input type="file" class="form-control" accept="image/*" onchange="handleImage(this)">
                    </div>
                </div>

                <div class="row g-2">
                    <div class="col-6"><label>First Name</label><input id="fn" class="form-control" placeholder="FIRST NAME" oninput="liveUpdate()"></div>
                    <div class="col-6"><label>Last Name</label><input id="ln" class="form-control" placeholder="LAST NAME" oninput="liveUpdate()"></div>
                </div>
                <div class="mt-2"><label>Contact Info</label>
                    <div class="row g-2">
                        <div class="col-6"><input id="em" class="form-control" placeholder="EMAIL" oninput="liveUpdate()"></div>
                        <div class="col-6"><input id="ph" class="form-control" placeholder="PHONE" oninput="liveUpdate()"></div>
                    </div>
                    <div class="row g-2 mt-1">
                        <div class="col-6"><input id="li" class="form-control" placeholder="LINKEDIN" oninput="liveUpdate()"></div>
                        <div class="col-6"><input id="gh" class="form-control" placeholder="GITHUB/PORTFOLIO" oninput="liveUpdate()"></div>
                    </div>
                </div>

                <div class="mt-3">
                    <label>Summary</label>
                    <div class="toolbar"><button onclick="format('bold')">B</button><button onclick="format('insertUnorderedList')">•</button></div>
                    <div id="sm" contenteditable="true" class="rich-editor" data-placeholder="Brief professional bio..." oninput="liveUpdate()"></div>
                </div>

                <div class="mt-3 d-flex justify-content-between align-items-center"><h6 class="text-info m-0 small">Experience</h6><button class="btn btn-sm glass-btn py-0 px-2" onclick="addExp()">+ Add</button></div>
                <div id="exp-container" class="mt-1"></div>

                <div class="mt-3 d-flex justify-content-between align-items-center"><h6 class="text-info m-0 small">Education</h6><button class="btn btn-sm glass-btn py-0 px-2" onclick="addEdu()">+ Add</button></div>
                <div id="edu-container" class="mt-1"></div>

                <div class="mt-3 d-flex justify-content-between align-items-center"><h6 class="text-info m-0 small">Projects</h6><button class="btn btn-sm glass-btn py-0 px-2" onclick="addProj()">+ Add</button></div>
                <div id="proj-container" class="mt-1"></div>

                <div class="mt-3">
                    <label>Roles & Responsibilities</label>
                    <div class="toolbar"><button onclick="format('bold')">B</button><button onclick="format('insertUnorderedList')">•</button></div>
                    <div id="roles" contenteditable="true" class="rich-editor" data-placeholder="Define core responsibilities across your career..." oninput="liveUpdate()"></div>
                </div>

                <div class="mt-3"><label>Skills</label><div id="sk" contenteditable="true" class="rich-editor" oninput="liveUpdate()"></div></div>
                <div class="mt-3"><label>Certifications</label><div id="cert" contenteditable="true" class="rich-editor" oninput="liveUpdate()"></div></div>
                <div class="mt-3"><label>Languages</label><div id="lang" contenteditable="true" class="rich-editor" oninput="liveUpdate()"></div></div>

                <div class="mt-3 d-flex justify-content-between align-items-center"><h6 class="text-info m-0 small">References</h6><button class="btn btn-sm glass-btn py-0 px-2" onclick="addRef()">+ Add</button></div>
                <div id="ref-container" class="mt-1"></div>

                <div class="mt-4 p-2 bg-dark rounded border border-secondary">
                    <label class="mb-1">Order</label>
                    <ul id="section-sort" class="list-group">
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="summary">Summary</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="experience">Experience</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="education">Education</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="projects">Projects</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="roles">Roles</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="skills">Skills</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="certifications">Certifications</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="languages">Languages</li>
                        <li class="list-group-item bg-transparent text-white border-secondary py-1 small" data-id="references">References</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-lg-7"><div id="resume-target" class="resume-preview"></div></div>
    </div>
</div>

<script>
    let currentStyle = 'apollo';
    let base64Photo = "";
    Sortable.create(document.getElementById('section-sort'), { animation: 150, onEnd: liveUpdate });
    
    function setStyle(s, el) {
        currentStyle = s;
        document.querySelectorAll('.template-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        liveUpdate();
    }
    
    function updateAccent(val) {
        document.documentElement.style.setProperty('--accent', val);
        document.documentElement.style.setProperty('--neon', `0 0 10px ${val}99`);
        liveUpdate();
    }

    function format(cmd) { document.execCommand(cmd, false, null); liveUpdate(); }
    
    function handleImage(input) {
        const file = input.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                base64Photo = e.target.result;
                document.getElementById('profileImg').src = base64Photo;
                document.getElementById('profileImg').style.display = "block";
                document.getElementById('photo-placeholder').style.display = "none";
                liveUpdate();
            };
            reader.readAsDataURL(file);
        }
    }
    
    function addExp() {
        const id = Date.now();
        const html = `<div class="entry-card" id="exp-${id}">
            <input class="form-control mb-1 fw-bold exp-co" placeholder="COMPANY" oninput="liveUpdate()">
            <input class="form-control mb-1 exp-ro" placeholder="ROLE" oninput="liveUpdate()">
            <input class="form-control mb-1 exp-lo" placeholder="LOCATION" oninput="liveUpdate()">
            <div class="row g-1 mb-1"><div class="col"><input type="month" class="form-control exp-sd" oninput="liveUpdate()"></div><div class="col"><input type="month" class="form-control exp-ed" oninput="liveUpdate()"></div></div>
            <div contenteditable="true" class="rich-editor exp-de" oninput="liveUpdate()"></div>
            <button class="btn btn-sm glass-btn glass-btn-danger mt-1 w-100" onclick="removeEl('exp-${id}')">Remove</button>
        </div>`;
        document.getElementById('exp-container').insertAdjacentHTML('beforeend', html);
        liveUpdate();
    }

    function addEdu() {
        const id = Date.now();
        const html = `<div class="entry-card" id="edu-${id}">
            <input class="form-control mb-1 fw-bold edu-sc" placeholder="UNIVERSITY" oninput="liveUpdate()">
            <input class="form-control mb-1 edu-dg" placeholder="DEGREE" oninput="liveUpdate()">
            <div class="row g-1 mb-1"><div class="col"><input type="month" class="form-control edu-sd" oninput="liveUpdate()"></div><div class="col"><input type="month" class="form-control edu-ed" oninput="liveUpdate()"></div></div>
            <div contenteditable="true" class="rich-editor edu-ac" oninput="liveUpdate()"></div>
            <button class="btn btn-sm glass-btn glass-btn-danger mt-1 w-100" onclick="removeEl('edu-${id}')">Remove</button>
        </div>`;
        document.getElementById('edu-container').insertAdjacentHTML('beforeend', html);
        liveUpdate();
    }
    
    function addProj() {
        const id = Date.now();
        const html = `<div class="entry-card" id="prj-${id}">
            <input class="form-control mb-1 fw-bold prj-ti" placeholder="PROJECT TITLE" oninput="liveUpdate()">
            <input class="form-control mb-1 prj-ro" placeholder="ROLE IN PROJECT" oninput="liveUpdate()">
            <input class="form-control mb-1 prj-lk" placeholder="LIVE LINK / REPO" oninput="liveUpdate()">
            <div contenteditable="true" class="rich-editor prj-de" oninput="liveUpdate()"></div>
            <button class="btn btn-sm glass-btn glass-btn-danger mt-1 w-100" onclick="removeEl('prj-${id}')">Remove</button>
        </div>`;
        document.getElementById('proj-container').insertAdjacentHTML('beforeend', html);
        liveUpdate();
    }

    function addRef() {
        const id = Date.now();
        const html = `<div class="entry-card" id="ref-${id}">
            <input class="form-control mb-1 fw-bold ref-na" placeholder="NAME" oninput="liveUpdate()">
            <input class="form-control mb-1 ref-ti" placeholder="TITLE / COMPANY" oninput="liveUpdate()">
            <input class="form-control mb-1 ref-em" placeholder="EMAIL / PHONE" oninput="liveUpdate()">
            <button class="btn btn-sm glass-btn glass-btn-danger mt-1 w-100" onclick="removeEl('ref-${id}')">Remove</button>
        </div>`;
        document.getElementById('ref-container').insertAdjacentHTML('beforeend', html);
        liveUpdate();
    }
    
    function removeEl(id) { document.getElementById(id).remove(); liveUpdate(); }
    function resetForm() { if(confirm("Clear data?")) location.reload(); }
    function hasV(el) { return el && el.innerText.trim().length > 0; }
    
    function getSections(headerColor) {
        const order = Array.from(document.querySelectorAll('#section-sort li')).map(li => li.dataset.id);
        const hStyle = `color:${headerColor}; border-color:${headerColor}33`;
        let html = '';
        order.forEach(id => {
            if (id === 'summary' && hasV(document.getElementById('sm'))) html += `<div class="sec-item"><div class="section-header" style="${hStyle}">SUMMARY</div>${document.getElementById('sm').innerHTML}</div>`;
            if (id === 'experience') {
                const items = Array.from(document.querySelectorAll('#exp-container .entry-card')).filter(e => e.querySelector('.exp-co').value);
                if (items.length) {
                    html += `<div class="sec-item"><div class="section-header" style="${hStyle}">EXPERIENCE</div>`;
                    items.forEach(el => {
                        html += `<div class="sec-item"><div style="display:flex; justify-content:space-between;"><strong>${el.querySelector('.exp-ro').value}</strong><span>${el.querySelector('.exp-sd').value} — ${el.querySelector('.exp-ed').value || 'Present'}</span></div><div style="opacity:0.8;">${el.querySelector('.exp-co').value} | ${el.querySelector('.exp-lo').value}</div><div>${el.querySelector('.exp-de').innerHTML}</div></div>`;
                    });
                    html += `</div>`;
                }
            }
            if (id === 'education') {
                const items = Array.from(document.querySelectorAll('#edu-container .entry-card')).filter(e => e.querySelector('.edu-sc').value);
                if (items.length) {
                    html += `<div class="sec-item"><div class="section-header" style="${hStyle}">EDUCATION</div>`;
                    items.forEach(el => {
                        html += `<div class="sec-item"><div style="display:flex; justify-content:space-between;"><strong>${el.querySelector('.edu-sc').value}</strong><span>${el.querySelector('.edu-sd').value} — ${el.querySelector('.edu-ed').value || 'Present'}</span></div><div style="opacity:0.8;">${el.querySelector('.edu-dg').value}</div><div>${el.querySelector('.edu-ac').innerHTML}</div></div>`;
                    });
                    html += `</div>`;
                }
            }
            if (id === 'projects') {
                const items = Array.from(document.querySelectorAll('#proj-container .entry-card')).filter(e => e.querySelector('.prj-ti').value);
                if (items.length) {
                    html += `<div class="sec-item"><div class="section-header" style="${hStyle}">PROJECTS</div>`;
                    items.forEach(el => {
                        const link = el.querySelector('.prj-lk').value;
                        const prole = el.querySelector('.prj-ro').value;
                        html += `<div class="sec-item"><div style="display:flex; justify-content:space-between;"><strong>${el.querySelector('.prj-ti').value}</strong><span>${prole}</span></div> ${link ? '<small style="opacity:0.6;">('+link+')</small>' : ''}<div>${el.querySelector('.prj-de').innerHTML}</div></div>`;
                    });
                    html += `</div>`;
                }
            }
            if (id === 'roles' && hasV(document.getElementById('roles'))) html += `<div class="sec-item"><div class="section-header" style="${hStyle}">ROLES & RESPONSIBILITIES</div>${document.getElementById('roles').innerHTML}</div>`;
            if (id === 'skills' && hasV(document.getElementById('sk'))) html += `<div class="sec-item"><div class="section-header" style="${hStyle}">SKILLS</div>${document.getElementById('sk').innerHTML}</div>`;
            if (id === 'certifications' && hasV(document.getElementById('cert'))) html += `<div class="sec-item"><div class="section-header" style="${hStyle}">CERTIFICATIONS</div>${document.getElementById('cert').innerHTML}</div>`;
            if (id === 'languages' && hasV(document.getElementById('lang'))) html += `<div class="sec-item"><div class="section-header" style="${hStyle}">LANGUAGES</div>${document.getElementById('lang').innerHTML}</div>`;
            if (id === 'references') {
                const items = Array.from(document.querySelectorAll('#ref-container .entry-card'));
                if (items.length) {
                    html += `<div class="sec-item"><div class="section-header" style="${hStyle}">REFERENCES</div><div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">`;
                    items.forEach(el => {
                        html += `<div><strong>${el.querySelector('.ref-na').value}</strong><br><small>${el.querySelector('.ref-ti').value}</small><br><small>${el.querySelector('.ref-em').value}</small></div>`;
                    });
                    html += `</div></div>`;
                }
            }
        });
        return html;
    }
    
    function liveUpdate() {
        const target = document.getElementById('resume-target');
        const fCol = document.getElementById('fontColor').value;
        const bCol = document.getElementById('bgColor').value;
        const accent = getComputedStyle(document.documentElement).getPropertyValue('--accent');
        target.style.color = fCol;
        target.style.backgroundColor = bCol;
        target.style.fontFamily = "'Inter', sans-serif";
        target.style.textAlign = 'left';
        target.style.display = 'block';

        const fn = document.getElementById('fn').value || 'YOUR';
        const ln = document.getElementById('ln').value || 'NAME';
        const contact = [document.getElementById('em').value, document.getElementById('ph').value, document.getElementById('li').value, document.getElementById('gh').value].filter(v=>v).join(' | ');
        const photo = base64Photo ? `<img src="${base64Photo}" id="res-photo" style="width:80px; height:80px; object-fit:cover; border:2px solid ${accent}; margin-bottom:10px;">` : "";

        if (currentStyle === 'apollo') {
            target.style.textAlign = 'center'; target.style.fontFamily = "'Playfair Display', serif";
            target.innerHTML = `${photo ? `<div style="margin-bottom:10px">${photo}</div>` : ''}<h1 style="margin:0; font-weight:900;">${fn} ${ln}</h1><div style="opacity:0.7;">${contact}</div><br>${getSections(fCol)}`;
            if(photo) document.getElementById('res-photo').style.borderRadius = "50%";
        } else if (currentStyle === 'classic') {
            target.innerHTML = `<div style="display:flex; justify-content:space-between; align-items:center;"><div><h1>${fn} ${ln}</h1><div>${contact}</div></div>${photo}</div><hr>${getSections(fCol)}`;
        } else if (currentStyle === 'modern') {
            target.innerHTML = `<div style="background:${fCol}; color:${bCol}; padding:25px; margin:-45px -45px 25px -45px; display:flex; gap:20px; align-items:center;">${photo}<div><h1 style="margin:0;">${fn} ${ln}</h1><div>${contact}</div></div></div>${getSections(fCol)}`;
        } else if (currentStyle === 'sidebar') {
            target.style.display = 'grid'; target.style.gridTemplateColumns = '180px 1fr'; target.style.gap = '25px';
            target.innerHTML = `<div style="border-right:1px solid ${fCol}33; padding-right:15px; text-align:center;">${photo}<h2 style="font-weight:800; margin-top:10px;">${fn}</h2>${contact}</div><div>${getSections(fCol)}</div>`;
        } else if (currentStyle === 'midnight') {
            target.style.backgroundColor = '#0f172a'; target.style.color = '#f1f5f9';
            target.innerHTML = `<div style="display:flex; justify-content:space-between;"><div><h1 style="color:${accent};">${fn} ${ln}</h1><div>${contact}</div></div>${photo}</div><br>${getSections(accent)}`;
        } else if (currentStyle === 'executive') {
            target.innerHTML = `<div style="border-left:8px solid ${accent}; padding-left:20px; display:flex; justify-content:space-between;"><div><h1 style="margin:0;">${fn} ${ln}</h1><div style="text-transform:uppercase;">Overview</div></div>${photo}</div><br>${getSections(fCol)}`;
        } else if (currentStyle === 'creative') {
            target.style.fontFamily = "'Montserrat', sans-serif";
            target.innerHTML = `<div style="background:linear-gradient(45deg, ${accent}, ${fCol}); color:${bCol}; padding:30px; margin:-45px -45px 25px -45px; text-align:right;">${photo}<h1>${fn} ${ln}</h1><div>${contact}</div></div>${getSections(fCol)}`;
        } else if (currentStyle === 'tech') {
            target.style.fontFamily = "'Fira Code', monospace"; target.style.background = "#000"; target.style.color = "#00ff41";
            target.innerHTML = `<div>> USER: ${fn}_${ln}</div><div>> ADDR: ${contact}</div><hr style="border-color:#00ff41">${getSections("#00ff41")}`;
        } else if (currentStyle === 'timeline') {
            target.innerHTML = `<div style="display:flex; align-items:center; gap:20px;">${photo}<h1>${fn} ${ln}</h1></div><div style="border-left:2px solid ${accent}; padding-left:20px; margin-top:20px;">${getSections(fCol)}</div>`;
        } else if (currentStyle === 'grid') {
            target.innerHTML = `<div style="display:grid; grid-template-columns:1fr 1fr; border-bottom:2px solid ${accent}; padding-bottom:10px; margin-bottom:20px;"><div><h1>${fn} ${ln}</h1></div><div style="text-align:right;">${contact}</div></div><div style="display:grid; grid-template-columns:1fr 1fr; gap:30px;">${getSections(fCol)}</div>`;
        } else if (currentStyle === 'optimism') {
            target.style.fontFamily = "'Quicksand', sans-serif"; target.style.borderRadius = "40px";
            target.innerHTML = `<div style="background:${accent}22; padding:30px; border-radius:30px; margin-bottom:20px; text-align:center;">${photo}<h1>${fn} ${ln}</h1><p>${contact}</p></div>${getSections(fCol)}`;
            if(photo) document.getElementById('res-photo').style.borderRadius = "20px";
        } else if (currentStyle === 'startup') {
            target.innerHTML = `<div style="border-bottom:5px solid ${accent}; padding-bottom:10px; margin-bottom:30px;"><h1 style="font-size:3rem; font-weight:800; letter-spacing:-2px;">${fn}</h1><h2 style="opacity:0.6;">${ln}</h2><p>${contact}</p></div>${getSections(fCol)}`;
        } else if (currentStyle === 'bold') {
            target.innerHTML = `<div style="border:10px solid ${fCol}; padding:20px; margin-bottom:20px;"><h1 style="font-size:4rem; line-height:1; font-weight:900;">${fn}<br>${ln}</h1><p>${contact}</p></div>${getSections(fCol)}`;
        } else if (currentStyle === 'minimal') {
            target.style.fontSize = "0.75rem"; target.style.padding = "80px";
            target.innerHTML = `<div style="margin-bottom:50px;"><h2>${fn} ${ln}</h2><p style="opacity:0.5;">${contact}</p></div>${getSections(fCol)}`;
        } else if (currentStyle === 'elegant') {
            target.style.fontFamily = "'Playfair Display', serif";
            target.innerHTML = `<div style="text-align:center; border:1px solid ${fCol}33; padding:40px; margin-bottom:30px;"><h1>${fn} ${ln}</h1><div style="letter-spacing:4px; font-size:0.7rem;">${contact.toUpperCase()}</div></div>${getSections(fCol)}`;
        } else if (currentStyle === 'monochrome') {
            target.style.backgroundColor = "#000"; target.style.color = "#fff";
            target.innerHTML = `<h1 style="font-size:4rem; border-bottom:10px solid #fff;">${fn}</h1><p>${contact}</p>${getSections("#fff")}`;
        } else if (currentStyle === 'aura') {
            target.innerHTML = `<div style="box-shadow: 0 0 50px ${accent}33; padding:20px; border-radius:15px;"><h1>${fn} ${ln}</h1><p>${contact}</p></div><br>${getSections(fCol)}`;
        } else if (currentStyle === 'clean') {
            target.innerHTML = `<div style="display:flex; align-items:baseline; gap:10px; border-bottom:1px solid #ddd; padding-bottom:5px; margin-bottom:20px;"><h1>${fn} ${ln}</h1><p style="font-size:0.8rem; margin-left:auto;">${contact}</p></div>${getSections(fCol)}`;
        }
    }
    
    function exportPDF() { html2pdf().set({ margin: 10, filename: 'resume.pdf', html2canvas: { scale: 2 }, jsPDF: { unit: 'mm', format: 'a4' }, pagebreak: { mode: 'avoid-all' } }).from(document.getElementById('resume-target')).save(); }
    function exportJSON() { const d = { fn: document.getElementById('fn').value, ln: document.getElementById('ln').value, em: document.getElementById('em').value, ph: document.getElementById('ph').value, li: document.getElementById('li').value, gh: document.getElementById('gh').value, sm: document.getElementById('sm').innerHTML, sk: document.getElementById('sk').innerHTML, cert: document.getElementById('cert').innerHTML, accent: document.querySelector('input[type="color"]').value, fontCol: document.getElementById('fontColor').value, bgCol: document.getElementById('bgColor').value, style: currentStyle, photo: base64Photo }; const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([JSON.stringify(d)], {type: 'application/json'})); a.download = `resume_save.json`; a.click(); }
    function importJSON(e) { const f = e.target.files[0]; if(!f) return; const r = new FileReader(); r.onload = (re) => { const d = JSON.parse(re.target.result); document.getElementById('fn').value = d.fn || ""; document.getElementById('ln').value = d.ln || ""; document.getElementById('em').value = d.em || ""; document.getElementById('ph').value = d.ph || ""; if(d.accent) updateAccent(d.accent); if(d.fontCol) document.getElementById('fontColor').value = d.fontCol; if(d.bgCol) document.getElementById('bgColor').value = d.bgCol; if(d.photo) { base64Photo = d.photo; document.getElementById('profileImg').src = base64Photo; document.getElementById('profileImg').style.display = "block"; document.getElementById('photo-placeholder').style.display = "none"; } liveUpdate(); }; r.readAsText(f); }
    window.onload = () => { addExp(); liveUpdate(); };
</script>
</body>
</html>
