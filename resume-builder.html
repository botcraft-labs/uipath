<!DOCTYPE html>
<html>
<head>
<title>Bot Craft Resume Studio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>

body{background:#eef1f6;font-family:"Segoe UI"}
.navbar{font-weight:700}
.container-area{margin-top:80px}

.panel{
background:white;padding:18px;border-radius:12px;
box-shadow:0 10px 25px rgba(0,0,0,.08)
}

.template-card{
padding:12px;border:2px solid #ddd;border-radius:12px;
cursor:pointer;font-weight:600;background:white;transition:0.3s
}
.template-card:hover{transform:translateY(-2px)}
.template-card.active{border-color:black;background:#f0f0f0}

.resume{
background:white;border-radius:12px;
box-shadow:0 10px 25px rgba(0,0,0,.1)
}
.page{padding:35px}

.section-title{font-weight:900;border-bottom:1px solid #000;margin-bottom:8px}

.item{margin-bottom:10px}

.timeline-item{
border-left:3px solid black;
padding-left:10px;
margin-bottom:10px
}

.two-col{
display:grid;
grid-template-columns:1.3fr 1fr;
gap:25px
}

.heading-name{font-size:30px;font-weight:900}
.heading-contact{font-size:15px}

</style>
</head>

<body>

<!-- Navbar -->
<nav class="navbar navbar-dark bg-dark fixed-top">
<div class="container">
<span class="navbar-brand">ü§ñ Bot Craft Labs ‚Äî Resume Studio</span>
</div>
</nav>

<div class="container container-area">
<div class="row">

<!-- LEFT PANEL -->
<div class="col-md-5">
<div class="panel">

<h4>Select Template</h4>
<div class="d-flex gap-2 flex-wrap" id="templates">
<div class="template-card active" onclick="selectTemplate('apollo',this)">Apollo (Corporate 2-Column)</div>
<div class="template-card" onclick="selectTemplate('terra',this)">Terra (Timeline)</div>
<div class="template-card" onclick="selectTemplate('aurora',this)">Aurora (Classic)</div>
</div>

<hr>

<h5>Personal</h5>
<input id="first" class="form-control mb-2" placeholder="First Name">
<input id="last" class="form-control mb-2" placeholder="Last Name">
<input id="email" class="form-control mb-2" placeholder="Email">
<input id="phone" class="form-control mb-2" placeholder="Phone">
<input id="loc" class="form-control mb-2" placeholder="Location">

<h5>Summary</h5>
<textarea id="summary" class="form-control mb-2" rows="3"></textarea>

<h5>Experience</h5>
<div id="exp"></div>
<button class="btn btn-outline-dark mb-2" onclick="addExp()">+ Add Experience</button>

<h5>Skills</h5>
<input id="skills" class="form-control mb-2" placeholder="Comma separated">

<hr>
<button class="btn btn-dark w-100" onclick="preview()">Preview</button>
<button class="btn btn-success w-100 mt-2" onclick="exportPDF()">Export PDF</button>

</div>
</div>

<!-- RIGHT PREVIEW -->
<div class="col-md-7">
<div class="resume">
<div class="page" id="resumePreview">
Select a template and start entering details‚Ä¶
</div>
</div>
</div>

</div>
</div>

<script>

// ================= CONFIG =================
// Update to your deployed backend URL
const BACKEND_URL = "http://localhost:5000/export";
// Example when deployed to Render:
// const BACKEND_URL = "https://your-backend.onrender.com/export";

// ========= TEMPLATE HANDLER =========
let template="apollo";

function selectTemplate(t,el){
template=t;
document.querySelectorAll(".template-card").forEach(c=>c.classList.remove("active"));
el.classList.add("active");
preview();
}

// ========= EXPERIENCE BUILDER =========
function addExp(){
let d=document.createElement("div");
d.className="border p-2 mb-2";

d.innerHTML=`
<input class="form-control mb-1 c" placeholder="Company">
<input class="form-control mb-1 r" placeholder="Role / Designation">

<div class="d-flex gap-2 mb-1">
<input type="date" class="form-control s">
<input type="date" class="form-control e">
</div>

<div class="form-check mb-1">
<input class="form-check-input cur" type="checkbox">
<label class="form-check-label">Currently Working</label>
</div>

<textarea class="form-control mb-1 d" placeholder="Responsibilities / Work Done"></textarea>

<button class="btn btn-sm btn-danger" onclick="this.parentElement.remove()">Delete</button>
`;
document.getElementById("exp").appendChild(d);
}

// ========= PREVIEW UI (Frontend Only) =========
function preview(){

const name = `${first.value} ${last.value}`.trim() || "Your Name";
const contact = `${email.value} | ${phone.value} | ${loc.value}`;
const summaryText = summary.value;
const skillsText = skills.value;

/* Build Experience HTML same as backend requires */
let exHTML="";
document.querySelectorAll("#exp>div").forEach(e=>{
const start=e.querySelector(".s").value;
const end=e.querySelector(".cur").checked ? "Present" : e.querySelector(".e").value;
const block = `
<div class="${template==='terra'?'timeline-item':'item'}">
<b>${e.querySelector(".c").value}</b> ‚Äî ${e.querySelector(".r").value}
<br>
<small>${start} ‚ûù ${end}</small>
<br>${e.querySelector(".d").value}
</div>`;
exHTML+=block;
});

/* -------- Template Layout Engine -------- */

if(template==="apollo"){
document.getElementById("resumePreview").innerHTML=`
<div class="heading-name">${name}</div>
<div class="heading-contact">${contact}</div>
<hr>

<div class="two-col">

<div>
<div class="section-title">Experience</div>
${exHTML}
</div>

<div>
<div class="section-title">Summary</div>
<p>${summaryText}</p>

<div class="section-title">Skills</div>
<p>${skillsText}</p>
</div>

</div>`;
return;
}

if(template==="terra"){
document.getElementById("resumePreview").innerHTML=`
<div class="heading-name">${name}</div>
<div class="heading-contact">${contact}</div>

<div class="section-title">Summary</div>
<p>${summaryText}</p>

<div class="section-title">Experience Timeline</div>
${exHTML}

<div class="section-title">Skills</div>
<p>${skillsText}</p>`;
return;
}

document.getElementById("resumePreview").innerHTML=`
<div class="heading-name">${name}</div>
<div class="heading-contact">${contact}</div>

<div class="section-title">Summary</div>
<p>${summaryText}</p>

<div class="section-title">Experience</div>
${exHTML}

<div class="section-title">Skills</div>
<p>${skillsText}</p>`;
}

// ========= EXPORT TO BACKEND =========
function exportPDF(){

const name = `${first.value} ${last.value}`.trim();
if(!name){ alert("Enter name first"); return; }

// Build Experience HTML for backend
let experienceHTML="";
document.querySelectorAll("#exp>div").forEach(e=>{
const start=e.querySelector(".s").value;
const end=e.querySelector(".cur").checked ? "Present" : e.querySelector(".e").value;
experienceHTML+=`
<div class="item">
<b>${e.querySelector(".c").value}</b> ‚Äî ${e.querySelector(".r").value}
<br>
<small>${start} ‚ûù ${end}</small>
<br>${e.querySelector(".d").value}
</div>`;
});

const payload = {
 template,
 resume:{
   name: `${first.value} ${last.value}`,
   contact: `${email.value} | ${phone.value} | ${loc.value}`,
   summary: summary.value,
   experience: experienceHTML,
   skills: skills.value
 }
};

fetch(BACKEND_URL,{
 method:"POST",
 headers:{"Content-Type":"application/json"},
 body:JSON.stringify(payload)
})
.then(res=>res.blob())
.then(file=>{
 const link=document.createElement("a");
 link.href=URL.createObjectURL(file);
 link.download="resume.pdf";
 link.click();
})
.catch(()=>{
 alert("Backend not reachable. Start server or update BACKEND_URL");
});
}

</script>

</body>
</html>
